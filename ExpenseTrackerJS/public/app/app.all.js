!function(t){"use strict";const a=function(t,a){t.hashPrefix("!"),a.when("/dashboard",{template:"<dashboard></dashboard>"}).when("/summary",{template:"<summary></summary>"}).when("/search/:drill",{template:"<search></search>"}).when("/search",{template:"<search></search>"}).when("/startup",{template:"<startup></startup>"}).otherwise("/startup")};t.module("app").config(a),a.$inject=["$locationProvider","$routeProvider"]}(window.angular),function(t){"use strict";t.module("core").constant("CONSTANTS",{MSG:{INFO:"info",SUCCESS:"success",WARNING:"warning",DANGER:"danger"},SIZES:{SUMMARY_COL:13,CHART_COL:12,SEARCH_ROW:13,DASHBOARD_ROW:4,BILLS_ROW:2,ACCTS_COL:6,PAGINATE_BTN:5},AMOUNT_REGEXP:/^-?\d+(?:\.\d{2}){0,1}$/,BASE_URL:".",PAGES:{DASHBOARD:"DASHBOARD",SUMMARY:"SUMMARY",SEARCH:"SEARCH"},HREF:{DASHBOARD:"/dashboard",SUMMARY:"/summary",SEARCH:"/search"},CURRENCY:{USD:"USD",INR:"INR"}})}(window.angular),function(t){"use strict";t.module("core").value("VALUES",{data:{env:null,city:{},cities:[],categories:[],allCategories:[],descriptions:[],accounts:[],allAccounts:[],transMonths:[],entryMonths:[],bills:[]}})}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c){const r=100,s=function(){e.data.page=o.PAGES.DASHBOARD,n.data.rowCount=o.SIZES.DASHBOARD_ROW,e.checkInit(),t.initialize(),a.setFlags(),d()},d=function(){!i.data.city.id||e.data.loading?c(function(){d()},r):t.loadPage()};s()};t.module("dashboard").component("dashboard",{templateUrl:"dashboard/dashboard.htm",controller:a}),a.$inject=["dashboardwrapperService","dashboardFlagsService","etmenuService","explistService","CONSTANTS","VALUES","$timeout"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o){const i=function(){a.data.showAcctsRowOne=!0,e.data.showAdd=!0,o.data.showBills=!0,t.data.showingMoreAccounts=!1,a.data.showAcctsMore=!1,t.data.showingChart=!1,n.data.showChart=!1},c=function(){t.data.showingMoreAccounts=!t.data.showingMoreAccounts,a.data.showAcctsMore=!a.data.showAcctsMore},r=function(){t.data.showingChart=!t.data.showingChart,e.data.showAdd=!e.data.showAdd,n.data.showChart=!n.data.showChart,n.renderChart()};return{setFlags:i,toggleMoreAccounts:c,toggleChart:r}};t.module("dashboard").factory("dashboardFlagsService",a),a.$inject=["etmenuService","accountsService","addService","chartService","billsService"]}(window.angular),function(t){"use strict";const a=function(){const t={loading:{on:!1,donestep:0}};return{data:t}};t.module("dashboard").factory("dashboardService",a),a.$inject=[]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c){const r=function(){a.data.loading=!1,t.data.loading.on=!1},s=function(){a.data.loading=!0,t.data.loading.on=!0,t.data.loading.donestep=0,e.loadAllAccounts(),c.loadAllBills(),i.reloadExpenses(),r()},d=function(){o.data.thinList=!0,o.data.thinListToggle=!1,o.data.currPageNo=0,o.loadCurrentPage(),n.initializeData(),e.data.filterBy=null,c.data.filterApplied=!1,c.data.filterBy=null};return{loadPage:s,initialize:d}};t.module("dashboard").factory("dashboardwrapperService",a),a.$inject=["dashboardService","etmenuService","accountsService","searchService","explistService","explistwrapperService","billsService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c,r,s){const d=this,l=500,u=function(){e.loadAll(),d.data=t.data,d.data.href=o.HREF,t.checkInit(),t.data.showButtons=t.data.page===o.PAGES.DASHBOARD},f=function(){a.toggleMoreAccounts()},p=function(){a.toggleChart()},h=function(a){i.data.city=n.getObjectOf(t.data.menu.cities,a),e.loadOthers(),r(function(){g()},l)},g=function(){!i.data.city.id||t.data.loading?r(function(){g()},l):(s.reload(),c.path(o.HREF[t.data.page]))};d.toggleMoreAccounts=f,d.toggleChart=p,d.changeCity=h,u()};t.module("etmenu").component("etmenu",{templateUrl:"etmenu/etmenu.htm",controller:a}),a.$inject=["etmenuService","dashboardFlagsService","startupService","utilsService","CONSTANTS","VALUES","$location","$timeout","$route"]}(window.angular),function(t){"use strict";const a=function(t,a){const e={page:"",showButtons:!1,showingMoreAccounts:!1,showingChart:!1,loading:!1,menu:{city:{},cities:[],env:null},CURRENCY:t.CURRENCY},n=function(){e.menu=a.data},o=function(){e.menu&&e.menu.city&&e.menu.city.name||n()};return{data:e,checkInit:o}};t.module("etmenu").factory("etmenuService",a),a.$inject=["CONSTANTS","VALUES"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c,r,s){const d=this,l=500,u=function(){d.data=t.data,d.ta=c.data,a.data.page=i.PAGES.SEARCH,n.data.rowCount=i.SIZES.SEARCH_ROW,n.data.thinListToggle=!0,n.data.currPageNo=0,n.loadCurrentPage(),a.checkInit(),r.drill||t.initializeData(),f()},f=function(){!c.data.city.id||a.data.loading?s(function(){f()},l):t.doSearch()},p=function(){t.doSearch()};d.doSearch=p,u()};t.module("search").component("search",{templateUrl:"search/search.htm",controller:a}),a.$inject=["searchService","etmenuService","startupService","explistService","utilsService","CONSTANTS","VALUES","$routeParams","$timeout"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n){const o={thinList:!0},i=function(){o.category=null,o.description=null,o.amount=null,o.account=null,o.bill=null,o.transMonth=null,o.entryMonth=null,o.adjustInd=null,o.adhocInd=null,o.thinList=!0},c=function(t,a,e,n){const i=o[a];i&&i.id&&(t[e]=i.id,n&&(t[n]=i.aggregate))},r=function(){const t={cityId:e.data.menu.city.id,thinList:o.thinList};return o.description&&""!==o.description&&(t.description=o.description),o.amount&&""!==o.amount&&0!==o.amount&&(t.amount=o.amount),o.adjustInd&&(t.adjust=o.adjustInd),o.adhocInd&&(t.adhoc=o.adhocInd),c(t,"category","catId"),c(t,"account","acctId"),c(t,"bill","billId"),c(t,"transMonth","transMonth","transYear"),c(t,"entryMonth","entryMonth","entryYear"),t},s=function(e){a.loadData(e.data),a.data.thinList=o.thinList,t.data.loading.donestep=3},d=function(){a.data.loading=!0;const t=r();a.data.filterApplied=Object.keys(t).length>2,n.query("/search/go",t,s)};return{data:o,initializeData:i,doSearch:d,loadResults:s}};t.module("search").factory("searchService",a),a.$inject=["dashboardService","explistService","etmenuService","ajaxService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c){const r=this,s=500,d=function(){r.data=t.data,e.data.page=n.PAGES.SUMMARY,t.data.columns=n.SIZES.SUMMARY_COL,e.checkInit(),l()},l=function(){!o.data.city.id||e.data.loading?c(function(){l()},s):(t.data.months=o.data.transMonths,u())},u=function(){t.loadSummary()},f=function(e,n){a.initializeData(),e.id>0&&(a.data.category=e),a.data.transMonth=r.data.months[n],a.data.adjustInd="N",t.data.input.adhoc&&t.data.input.regular||(a.data.adhocInd=t.data.input.adhoc&&!t.data.input.regular?"Y":"N"),i.path("/search/Y")},p=function(){return t.data.currPageNo>0},h=function(){return t.data.currPageNo<t.data.maxPageNo},g=function(){t.data.currPageNo-=1,t.loadCurrentPage()},S=function(){t.data.currPageNo+=1,t.loadCurrentPage()};r.loadSummary=u,r.hasPrevPage=p,r.hasNextPage=h,r.prevPage=g,r.nextPage=S,r.listExpenses=f,d()};t.module("summary").component("summary",{templateUrl:"summary/summary.htm",controller:a}),a.$inject=["summaryService","searchService","etmenuService","CONSTANTS","VALUES","$location","$timeout"]}(window.angular),function(t){"use strict";const a=function(t,a){const e={months:[],totalrow:{},rows:[],pgData:{},maxPageNo:0,currPageNo:0,columns:0,input:{cityId:0,forecast:!1,adhoc:!0,regular:!0}},n=function(){const t=e.currPageNo,a=e.columns;e.pgData.months=e.months.slice(t*a,(t+1)*a),e.pgData.totalrow=e.totalrow.amount.slice(t*a,(t+1)*a);const n=[];e.rows.forEach(function(e){const o={};o.category=e.category,o.amount=e.amount.slice(t*a,(t+1)*a),o.count=e.count.slice(t*a,(t+1)*a),n.push(o)}),e.pgData.rows=n},o=function(a){e.totalrow=a.data.splice(0,1)[0],e.rows=a.data,e.maxPageNo=Math.ceil(e.months.length/e.columns)-1,e.currPageNo=0,n(),t.data.loading=!1},i=function(){t.data.loading=!0,e.input.cityId=t.data.menu.city.id,a.query("/summary/go",e.input,o)};return{data:e,loadSummary:i,loadCurrentPage:n}};t.module("summary").factory("summaryService",a),a.$inject=["etmenuService","ajaxService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i){const c=this,r=500,s=function(){c.data=t.data,t.loadAll(),d()},d=function(){!n.data.city.id||a.data.loading?i(function(){d()},r):o.path("/dashboard")};s()};t.module("startup").component("startup",{templateUrl:"startup/startup.htm",controller:a}),a.$inject=["startupService","etmenuService","CONSTANTS","VALUES","$location","$timeout"]}(window.angular),function(t){"use strict";const a=function(a,e,n,o,i){const c={status:0,connect:!1,loadInitiated:!1},r=10,s=100,d=10,l=function(){c.status>=s?a.data.loading=!1:i(function(){l()},d)},u=function(a){o.data.entryMonths=[],t.forEach(a.data,function(t){o.data.entryMonths.push(t)}),c.status+=r},f=function(t){e.query("/startup/months/entry",{cityId:t.id},u)},p=function(a){o.data.transMonths=[],t.forEach(a.data,function(t){o.data.transMonths.push(t)}),c.status+=r},h=function(t){e.query("/startup/months/trans",{cityId:t.id},p)},g=function(a){t.forEach(a.data,function(t){o.data.allAccounts.push(t)}),c.status+=r},S=function(t){e.query("/startup/accounts/inactive",{cityId:t.id},g)},m=function(a){o.data.accounts=[],o.data.allAccounts=[],t.forEach(a.data,function(t){o.data.accounts.push(t),o.data.allAccounts.push(t)}),c.status+=r},w=function(t){e.query("/startup/accounts",{cityId:t.id},m)},y=function(t){o.data.descriptions=t.data,c.status+=r},b=function(t){e.query("/startup/descriptions",{cityId:t.id},y)},v=function(t){o.data.allCategories=t.data,c.status+=r},A=function(t){e.query("/startup/categories/all",{cityId:t.id},v)},x=function(t){o.data.categories=t.data,c.status+=r},N=function(t){e.query("/startup/categories",{cityId:t.id},x)},P=function(t){o.data.cities=t.data,c.status+=r},E=function(){e.query("/startup/cities",{},P)},C=function(t){o.data.city=t.data,c.status+=r,E(),N(o.data.city),A(o.data.city),b(o.data.city),w(o.data.city),S(o.data.city),h(o.data.city),f(o.data.city),l()},I=function(){e.get("/startup/city/default",{},C)},O=function(t){c.connect=0===t.code,c.connect&&(o.data.env=t.data.env,c.status+=r,I())},$=function(){e.get("/startup/connect",{},O)},R=function(){c.loadInitiated||(a.data.loading=!0,c.loadInitiated=!0,$())},M=function(){a.data.loading=!0,N(o.data.city)};return{data:c,loadAll:R,loadOthers:M}};t.module("startup").factory("startupService",a),a.$inject=["etmenuService","ajaxService","CONSTANTS","VALUES","$timeout"]}(window.angular),function(t){"use strict";const a=function(){const t=function(t,a){$(a).hover(function(){$(a).tooltip("show")},function(){$(a).tooltip("hide")})};return{restrict:"A",link:t}};t.module("core.directives").directive("tooltip",a)}(window.angular),function(t){"use strict";const a=function(t,a){const e=function(e,n,o,i){i.$validators.xxAmount=function(a,e){return!(!i.$isEmpty(a)&&!t.AMOUNT_REGEXP.test(e))};const c=function(){const t=n.val().replace(/[^-.\d]/g,"");i.$viewValue=t,n.val(a("currency")(t))},r=function(){n.val(i.$viewValue)};i.$parsers.push(function(t){return t.replace(/[^-.\d]/g,"")}),i.$render=function(){n.val(a("currency")(i.$viewValue))},n.bind("focus",r),n.bind("focusout",c)};return{require:"ngModel",link:e}};t.module("core.directives").directive("xxAmount",a),a.$inject=["CONSTANTS","$filter"]}(window.angular),function(t){"use strict";const a=function(t,a){const e=function(t,e,n,o){o.$render=function(){e.val(a("date")(o.$viewValue,"dd-MMM-yyyy"))}};return{require:"ngModel",link:e}};t.module("core.directives").directive("xxDate",a),a.$inject=["CONSTANTS","$filter"]}(window.angular),function(t){"use strict";const a=function(t,a,e){const n=function(t){const n=a.BASE_URL+t;return e(n)},o=function(t,a,e){n(t).get(a,e,r)},i=function(t,a,e){n(t).get(a,e,r)},c=function(t,a,e){n(t).save(a,e,r)},r=function(e){t.show("AJAX Error!!.. "+e.status+" :: "+e.statusText,a.MSG.DANGER)};return{url:n,get:o,query:i,post:c}};t.module("core.services").factory("ajaxService",a),a.$inject=["utilsService","CONSTANTS","$resource"]}(window.angular),function(t){"use strict";const a=function(t){const a=2e3,e=function(t,a){const e={o:null,i:0};for(e.i=0;e.i<t.length;e.i++)if(t[e.i].id===Number(a)){e.o=t[e.i];break}return e.o},n=function(t,a){const e={idx:null,i:0};for(e.i=0;e.i<t.length;e.i++)if(t[e.i].id===Number(a)){e.idx=e.i;break}return e.idx},o=function(a,e){const n="<b>"+a+"</b> - "+(0===e?"Completed successfully.":"Failed."),o=0===e?t.MSG.SUCCESS:t.MSG.DANGER;i(n,o)},i=function(t,e){$.notify({icon:"notifications",message:t},{type:e,delay:a,placement:{from:"top",align:"center"}})};return{getObjectOf:e,getIndexOf:n,showMsg:o,show:i}};t.module("core.services").factory("utilsService",a),a.$inject=["CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n){const o=this,i=function(){o.data=t.data},c=function(a){t.data.filterBy!==a&&(t.filterAccount(a),n.reloadExpenses())},r=function(a){t.tallyAccount(a)},s=function(t){return moment().isSame(moment(t),"day")};o.filterAccount=c,o.tallyAccount=r,o.isTallyToday=s,i()};t.module("dashboard.accounts").component("accounts",{templateUrl:"dashboard/accounts/accounts.htm",controller:a}),a.$inject=["accountsService","dashboardService","billsService","explistwrapperService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i,c,r){const s={accts:null,rows:[],maxRows:0,showAcctsRowOne:!1,showAcctsMore:!1,filterBy:null,tallyOn:null},d=r.SIZES.ACCTS_COL,l=function(){const t={i:0};for(s.rows=[],t.i=0;t.i<s.maxRows;t.i++){const a={idx:t.i};a.cols=s.accts.slice(t.i*d,(t.i+1)*d),s.rows.push(a)}},u=function(t){a.data.loading.donestep=1,s.accts=t.data,s.maxRows=Math.ceil(s.accts.length/d),l()},f=function(){const a={cityId:t.data.menu.city.id};c.query("/startup/accounts",a,u)},p=function(a){s.accts[i.getIndexOf(s.accts,a.data.id)]=a.data,l(),t.data.loading=!1},h=function(a){t.data.loading=!0,c.get("/dashboard/account/"+a,{},p)},g=function(a){t.data.loading=!1,i.showMsg("Tally",a.code),0===a.code&&(h(s.tallyOn),o.doSearch())},S=function(a){t.data.loading=!0,s.tallyOn=a,c.post("/edit/tally/"+a,{},g)},m=function(t){s.filterBy=t,e.clearBillsList(),e.loadBillsForAcct(t),o.data.account={id:t},o.data.bill=null};return{data:s,loadAllAccounts:f,tallyAccount:S,filterAccount:m,refreshAccount:h}};t.module("dashboard.accounts").factory("accountsService",a),a.$inject=["etmenuService","dashboardService","billsService","explistService","searchService","utilsService","ajaxService","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o){const i=this,c=function(){i.data=t.data,i.ta=n.data},r=function(t){return!t||!t.id},s=function(t){return t&&t.id?t.id:0},d=function(a){if(a.$valid){if(t.data.expense.adjust){const n=t.data.expense.accounts;if(r(n.from)&&r(n.to))return e.show("Select at least one of From, To accounts!!",o.MSG.WARNING),!1;if(s(n.from)&&s(n.to)&&s(n.from)===s(n.to))return e.show("From & To accounts cannot be the same!!",o.MSG.WARNING),!1}t.addExpense()}};i.addExpense=d,c()};t.module("dashboard.add").component("add",{templateUrl:"dashboard/add/add.htm",controller:a}),a.$inject=["addService","explistService","utilsService","VALUES","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o){const i={showAdd:!1,expense:{city:null,adjust:!1,adhoc:!1,category:null,accounts:{from:null,to:null},description:"",amount:"",transDt:""}},c=function(){i.expense.amount="",i.expense.description=""},r=function(t){c(),o.showMsg("Add Expense",t.code),0===t.code&&(e.addItem(t.data.id),i.expense.accounts.from&&i.expense.accounts.from.id&&a.refreshAccount(i.expense.accounts.from.id),i.expense.accounts.to&&i.expense.accounts.to.id&&a.refreshAccount(i.expense.accounts.to.id))},s=function(){i.expense.city=t.data.menu.city,n.post("/edit/add",i.expense,r)};return{data:i,addExpense:s}};t.module("dashboard.add").factory("addService",a),a.$inject=["etmenuService","accountsService","explistwrapperService","ajaxService","utilsService"]}(window.angular),function(t){"use strict";const a=function(t,a,e){const n=this,o=function(){n.data=t.data,n.ta=e.data},i=function(e){e.$valid&&(a.data.loading=!0,t.payBill(),$("#model_BillPay").modal("hide"))};n.payBill=i,o()};t.module("dashboard.billpay").component("billpay",{templateUrl:"dashboard/billpay/billpay.htm",controller:a}),a.$inject=["billpayService","billsService","VALUES"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i){const c={bill:null,city:null,account:"",paidDt:""},r=function(){c.account="",c.paidDt=""},s=function(t){c.bill=t,r()},d=function(t){i.showMsg("Bill Pay",t.code),a.data.loading=!1,0===t.code&&(n.addItem(t.data.id),a.refreshBill(c.bill.id),e.refreshAccount(c.bill.account.id),e.refreshAccount(c.account.id))},l=function(){c.city=t.data.menu.city,o.post("/edit/paybill",c,d)};return{data:c,loadData:s,payBill:l}};t.module("dashboard.billpay").factory("billpayService",a),a.$inject=["etmenuService","billsService","accountsService","explistwrapperService","ajaxService","utilsService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o,i){const c=this,r=function(){c.data=a.data},s=function(){return a.data.currPageSet>0},d=function(){return(a.data.currPageSet+1)*a.data.pageSetSize<=a.data.maxPageNo},l=function(){a.data.currPageSet-=1},u=function(){a.data.currPageSet+=1},f=function(t){return a.data.currPageSet*a.data.pageSetSize+t},p=function(t){a.data.currPageNo=t,a.loadCurrentPage()},h=function(a){t.showBillPay(a),$("#model_BillPay").modal("show")},g=function(t){a.data.filterBy!==t&&(a.data.filterBy=t,i.data.bill={id:t},n.reloadExpenses())},S=function(){n.clearFilter()},m=function(){a.data.tab="OPEN",a.buildRowsForTab()},w=function(){a.data.tab="CLOSED",null==a.data.closedBills?null==e.data.filterBy?a.loadAllBills():a.loadBillsForAcct(e.data.filterBy):a.buildRowsForTab()};c.hasPrevPageSet=s,c.hasNextPageSet=d,c.prevPageSet=l,c.nextPageSet=u,c.page=f,c.loadPage=p,c.showBillPay=h,c.filterExpenses=g,c.clearFilter=S,c.showOpenBills=m,c.showClosedBills=w,r()};t.module("dashboard.bills").component("bills",{templateUrl:"dashboard/bills/bills.htm",controller:a}),a.$inject=["billswrapperService","billsService","accountsService","explistwrapperService","explistService","searchService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o){const i={showBills:!1,rows:[],pgData:{},currPageSet:0,currPageNo:0,maxPageNo:0,pageSetSize:o.SIZES.PAGINATE_BTN,tab:"OPEN",openBills:[],closedBills:null,filterApplied:!1,filterBy:null,loading:!1},c=o.SIZES.BILLS_ROW,r=function(){i.openBills=null,i.closedBills=null,i.tab="OPEN"},s=function(){const t=i.currPageNo;i.pgData.rows=i.rows.slice(t*c,(t+1)*c)},d=function(t){const a=n.getIndexOf(i.rows,t.data.id);i.rows[a]=t.data,s(),i.loading=!1},l=function(t){i.loading=!0,e.get("/dashboard/bill/"+t,{},d)},u=function(){i.rows="OPEN"===i.tab?i.openBills:i.closedBills,i.maxPageNo=Math.ceil(i.rows.length/c)-1,i.currPageSet=0,i.currPageNo=0,s(),i.loading=!1},f=function(t){a.data.loading.donestep=2,"OPEN"===i.tab?i.openBills=t.data:i.closedBills=t.data,u()},p=function(a){i.loading=!0,i.filterApplied=!0;const n={cityId:t.data.menu.city.id,acctId:a,paidInd:"OPEN"===i.tab?"N":"Y"};e.query("/dashboard/bills",n,f)},h=function(){i.loading=!0,i.filterApplied=!1;const a={cityId:t.data.menu.city.id,paidInd:"OPEN"===i.tab?"N":"Y"};e.query("/dashboard/bills",a,f)};return{data:i,clearBillsList:r,loadData:f,buildRowsForTab:u,loadCurrentPage:s,loadBillsForAcct:p,loadAllBills:h,refreshBill:l}};t.module("dashboard.bills").factory("billsService",a),a.$inject=["etmenuService","dashboardService","ajaxService","utilsService","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(t,a,e){const n=function(n){const o=e.getObjectOf(t.data.rows,n);a.loadData(o)};return{showBillPay:n}};t.module("dashboard.bills").factory("billswrapperService",a),a.$inject=["billsService","billpayService","utilsService"]}(window.angular),function(t){"use strict";const a=function(t){const a=this,e=function(){a.data=t.data};e()};t.module("dashboard.chart").component("chart",{templateUrl:"dashboard/chart/chart.htm",controller:a}),a.$inject=["chartService"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n){const o={showChart:!1,loaded:!1,labels:[],series:[],data:[],ds:[],options:{},cols:n.SIZES.CHART_COL},i=function(){o.options={scales:{yAxes:[{ticks:{max:5e3}}]}},o.ds=[{label:"Regular",backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,type:"bar"},{label:"Adhoc",backgroundColor:"rgba(255,99,132, 0.2)",borderColor:"rgba(255,99,132,1)",borderWidth:1,type:"bar"},{label:"Total",backgroundColor:"rgba(255, 206, 86, 0.2)",borderColor:"rgba(255, 206, 86, 1)",borderWidth:1,type:"line"}]},c=function(t){o.labels=t.data.labels.slice(0,o.cols),o.series=["Regular","Adhoc","Total"],o.data[0]=t.data.regulars.slice(0,o.cols),o.data[1]=t.data.adhocs.slice(0,o.cols),o.data[2]=t.data.totals.slice(0,o.cols),i(),o.loaded=!0,a.data.loading.donestep=4},r=function(){e.get("/summary/chart",{cityId:t.data.menu.city.id},c)},s=function(){o.loaded||r()};return{data:o,renderChart:s}};t.module("dashboard.chart").factory("chartService",a),a.$inject=["etmenuService","dashboardService","ajaxService","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n,o){const i=this,c=function(){i.data=t.data,i.ta=n.data},r=function(a){if(a.$valid){const n=t.data.expense.accounts;if(n.from.id&&t.data.expense.bill&&n.from.id!==t.data.expense.bill.account.id&&delete t.data.expense.bill,t.data.expense.adjust){if(s(n.from)&&s(n.to))return e.show("1 - Mandatory fields are empty!!",o.MSG.WARNING),!1;if(d(n.from)&&d(n.to)&&d(n.from)===d(n.to))return e.show("4 - From & To accounts cannot be the same!!",o.MSG.WARNING),!1}else{if(s(n.from)||s(t.data.expense.category))return e.show("2 - Mandatory fields are empty!!",o.MSG.WARNING),!1;if(n.from.billed&&s(t.data.expense.bill))return e.show("3 - Mandatory fields are empty!!",o.MSG.WARNING),!1}t.modifyExpense()}},s=function(t){return!t||!t.id},d=function(t){return t&&t.id?t.id:0},l=function(){!s(t.data.expense.accounts.from)&&t.data.expense.accounts.from.billed&&t.loadBills()},u=function(){n.data.bills=[]},f=function(){t.deleteExpense()};i.modifyExpense=r,i.deleteExpense=f,i.loadBills=l,i.clearBills=u,c()};t.module("dashboard.edit").component("edit",{templateUrl:"dashboard/edit/edit.htm",controller:a}),a.$inject=["editService","explistService","utilsService","VALUES","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(a,e,n,o,i,c,r){const s={expense:{},toRefresh:{accts:{},bills:{}},loading:!1},d=function(){s.toRefresh.accts={},s.toRefresh.bills={}},l=function(){s.toRefresh.accts[s.expense.accounts.from.id]=s.expense.accounts.from.id,s.toRefresh.accts[s.expense.accounts.to.id]=s.expense.accounts.to.id,s.expense.bill&&s.expense.bill.id&&(s.toRefresh.bills[s.expense.bill.id]=s.expense.bill.id)},u=function(){t.forEach(s.toRefresh.accts,function(t,a){a&&n.refreshAccount(a)}),t.forEach(s.toRefresh.bills,function(t,a){o.refreshBill(a)}),d()},f=function(t){r.data.bills=t.data},p=function(){const t={acctId:s.expense.accounts.from.id};i.query("/dashboard/bills",t,f)},h=function(t){d(),s.expense=t,s.expense.accounts.from.id&&(s.expense.accounts.from=c.getObjectOf(r.data.accounts,s.expense.accounts.from.id)),l(),s.expense.accounts.from.billed&&p()},g=function(t){s.loading=!1,c.showMsg("Modify Expense",t.code),0===t.code&&(e.modifyItem(s.expense.id),u()),$("#model_Modify").modal("hide")},S=function(){l(),i.post("/edit/modify",s.expense,g),s.loading=!0},m=function(t){s.loading=!1,c.showMsg("Delete Expense",t.code),0===t.code&&(e.deleteItem(s.expense.id),u()),$("#model_Delete").modal("hide")},w=function(){i.post("/edit/delete/"+s.expense.id,{},m),s.loading=!0};return{data:s,loadData:h,modifyExpense:S,deleteExpense:w,loadBills:p}};t.module("dashboard.edit").factory("editService",a),a.$inject=["etmenuService","explistwrapperService","accountsService","billsService","ajaxService","utilsService","VALUES"]}(window.angular),function(t){"use strict";const a=function(t,a,e,n){const o=this,i=function(){o.data=a.data},c=function(){return a.data.currPageSet>0},r=function(){return(a.data.currPageSet+1)*a.data.pageSetSize<=a.data.maxPageNo},s=function(){a.data.currPageSet-=1},d=function(){a.data.currPageSet+=1},l=function(t){return a.data.currPageSet*a.data.pageSetSize+t},u=function(t){a.data.currPageNo=t,a.loadCurrentPage()},f=function(t){h(t),$("#model_Modify").modal("show")},p=function(t){h(t),$("#model_Delete").modal("show")},h=function(t){const o=$.extend({},n.getObjectOf(a.data.rows,t));e.loadData(o)},g=function(e,o){const i=n.getIndexOf(a.data.rows,e);t.swapExpense(i,i+o)},S=function(){t.clearFilter()},m=function(){a.data.thinListToggle&&(a.data.thinList=!a.data.thinList,t.reloadExpenses())};o.hasPrevPageSet=c,o.hasNextPageSet=r,o.prevPageSet=s,o.nextPageSet=d,o.page=l,o.loadPage=u,o.showModifyExpense=f,o.showDeleteExpense=p,o.swapExpense=g,o.clearFilter=S,o.toggleThinList=m,i()};t.module("dashboard.explist").component("explist",{templateUrl:"dashboard/explist/explist.htm",controller:a}),a.$inject=["explistwrapperService","explistService","editService","utilsService"]}(window.angular),function(t){"use strict";const a=function(t,a){const e={pgData:{rows:[]},maxPageNo:0,currPageSet:0,currPageNo:0,rowCount:1,pageSetSize:a.SIZES.PAGINATE_BTN,loading:!1,filterApplied:!1,thinList:!0,thinListToggle:!1,total:0,rows:[]},n=function(){e.total=0,e.rows.forEach(function(t){e.total+=t.amount})},o=function(){const t=e.currPageNo;e.pgData.rows=e.rows.slice(t*e.rowCount,(t+1)*e.rowCount)},i=function(){e.maxPageNo=Math.ceil(e.rows.length/e.rowCount)-1,n(),o()},c=function(t){e.rows=t,e.currPageSet=0,e.currPageNo=0,e.loading=!1,i()},r=function(t){e.rows.unshift(t),i()},s=function(a){const n=t.getIndexOf(e.rows,a.id);e.rows[n]=a,i()},d=function(a){e.rows.splice(t.getIndexOf(e.rows,a),1),i()};return{data:e,loadData:c,paginate:i,loadCurrentPage:o,addItem:r,modifyItem:s,deleteItem:d}};t.module("dashboard.explist").factory("explistService",a),a.$inject=["utilsService","CONSTANTS"]}(window.angular),function(t){"use strict";const a=function(a,e,n,o,i,c,r,s,d){const l=1e3,u=10,f={swapPool:[],tempPool:[],publishing:!1,looperOn:!1},p=function(){n.data.thinList=a.data.thinList,n.doSearch()},h=function(){n.initializeData(),e.data.page===s.PAGES.DASHBOARD&&(o.data.filterBy&&(i.data.filterApplied=!1,i.clearBillsList(),i.loadAllBills()),i.data.filterBy=null,o.data.filterBy=null),p()},g=function(t){a.addItem(t.data)},S=function(t){c.get("/dashboard/transaction/"+t,{},g)},m=function(t){a.modifyItem(t.data)},w=function(t){c.get("/dashboard/transaction/"+t,{},m)},y=function(t){a.deleteItem(t)},b=function(){t.forEach(f.tempPool,function(t){const a={idx:-1,i:0};for(a.i=0;a.i<f.swapPool.length;a.i++)if(t.code===f.swapPool[a.i].code){a.idx=a.i;break}a.idx>-1&&f.swapPool.splice(a.idx,1)}),f.publishing=!1,a.data.loading=!1},v=function(){f.tempPool=[],t.forEach(f.swapPool,function(t){f.tempPool.push(t)}),a.data.loading=!0,c.post("/edit/swap/"+e.data.menu.city.id,f.tempPool,b)},A=function(){f.swapPool.length>0?(f.publishing||(f.publishing=!0,v()),d(function(){A()},l)):f.looperOn=!1},x=function(t,e){const n=a.data.rows[t].id,o=a.data.rows[e].id,i=n*u+o;f.swapPool.push({code:i,fromTrans:n,toTrans:o});const c=a.data.rows[t];a.data.rows[t]=a.data.rows[e],a.data.rows[e]=c,a.loadCurrentPage(),f.looperOn||(f.looperOn=!0,d(function(){A()},l))};return{clearFilter:h,reloadExpenses:p,addItem:S,modifyItem:w,deleteItem:y,swapExpense:x}};t.module("dashboard.explist").factory("explistwrapperService",a),a.$inject=["explistService","etmenuService","searchService","accountsService","billsService","ajaxService","utilsService","CONSTANTS","$timeout"]}(window.angular);